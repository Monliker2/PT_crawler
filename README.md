# Сканер с интеграцией VirusTotal

Данный проект реализует обход веб-страниц с поиском ссылок на файлы и (опционально) проверку найденных файлов через API VirusTotal.

## Структура проекта

```
├── main.py               # Основной скрипт обхода
├── virustotal_api.py     # Модуль для работы с VirusTotal API
├── requirements.txt      # Список зависимостей
└── README.md             # Инструкция и документация
```

## Установка

1. Клонируйте репозиторий:

   ```bash
   git clone https://github.com/Monliker2/PT_crawler.git
   cd PT_crawler
   ```
2. Установите зависимости (предпочтительно в виртуальном окружении):

   ```bash
   pip install -r requirements.txt
   ```

## Конфигурация

1. Получите API-ключ на сайте VirusTotal: [https://www.virustotal.com/](https://www.virustotal.com/)
2. Создайте файл `.env` и задайте:

   ```python
   VIRUS_TOTAL_API=YOUR_API_KEY
   ```

## Использование

### 1. Запуск без проверки в VirusTotal

По умолчанию скрипт просто обходит сайт, ищет ссылки на файлы и завершает работу при первой найденной ссылке:

```bash
python main.py <URL> [таймаут]
```

* `<URL>` — стартовая страница для обхода.
* `[таймаут]` — максимальное время работы в секундах (по умолчанию 30).

### 2. Запуск с проверкой через VirusTotal

Чтобы при нахождении ссылки на файл сразу проверять её через VirusTotal, укажите флаг `--vt` (или `--virustotal`):

```bash
python main.py <URL> [таймаут] --vt
```

При обнаружении файла скрипт выполнит:

1. Отправит URL файла в VirusTotal API.
2. Дождётся завершения анализа.
3. Выведет в лог статистику результатов (`malicious`, `suspicious`, `undetected`).

### 3. Примеры

```bash
# Обычный обход
python main.py https://example.com/page

# Обход с проверкой в VT, таймаут 60 секунд
python main.py https://example.com/page 60 --vt
```

## Разработка и тесты

* Логи выводятся через встроенный `logging`.
* Основная логика обхода в `scan()`.
* Функция проверки VT находится в `check_with_virustotal()`.

При необходимости расширить функционал:

* Обрабатывать все найденные ссылки вместо первой.
* Параметризовать количество попыток и задержку при запросах к VT.

